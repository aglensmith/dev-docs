{"path":"stencil-docs/customizing-checkout/checkout-sdk-example","templateID":0,"sharedPropsHashes":{"nav":"ZHaw9F","sidebarTree":"ne2ym","namespace":"Zd6xn0"},"localProps":{"version":"1.3","crumbs":[{"content":"Stencil Docs","to":"/stencil-docs"},{"content":"Customizing Checkout","to":"/stencil-docs/customizing-checkout"},{"content":"Checkout SDK Example","to":"/stencil-docs/customizing-checkout/checkout-sdk-example"}],"page":{"meta":{"title":"Checkout SDK Example - Customizing Checkout - Stencil Docs","url":"/stencil-docs/customizing-checkout/checkout-sdk-example","description":"Checkout SDK Tutorial\n\n\n\nOn This Page\n\nImplementing React Checkout in Cornerstone\n\nAdditional Customizations\n\nAdditional Resources\n\n\n\nThis tutorial demo..."},"title":"Checkout SDK Example","parsedPath":["pages","/stencil-docs","data","children",6,"data","children",4],"rootPagePath":"/stencil-docs","path":"/stencil-docs/customizing-checkout/checkout-sdk-example","isSubpage":true,"route":{"path":"/checkout-sdk-example"},"data":{"blocks":[{"type":"text","data":"# Checkout SDK Tutorial\r\n\r\n<div class=\"otp\" id=\"no-index\">\r\n\r\n### On This Page\r\n- [Implementing React Checkout in Cornerstone](#implementing-react-checkout-in-cornerstone)\r\n- [Additional Customizations](#additional-customizations)\r\n- [Additional Resources](#additional-resources)\r\n\r\n</div>\r\n\r\nThis tutorial demonstrates how to implement a custom checkout built with React on the Cornerstone theme. The checkout will utilize BigCommerce's Checkout SDK. This tutorial assumes [Cornerstone 3.4.0](https://github.com/bigcommerce/cornerstone/releases/tag/3.4.0) as a starting point.\r\n\r\n<div class=\"HubBlock--callout\">\r\n<div class=\"CalloutBlock--error\">\r\n<div class=\"HubBlock-content\">\r\n\r\n<!-- theme: error -->\r\n\r\n### Checkout Example not Intended for Production Use\r\n> The checkout example below is a good starting point; however it is **NOT intended for use in production**. Developers should test and make appropriate modifications before deploying.\r\n\r\n</div>\r\n</div>\r\n</div>\r\n\r\n### Prerequisites\r\n\r\nStencil CLI is required to begin this walkthrough. For installation instructions, see [Installing Stencil](/stencil-docs/getting-started/installing-stencil).\r\n\r\n## Implementing React Checkout in Cornerstone\r\n\r\n### Install Dependencies\r\n\r\nThe React app used to demonstrate the Checkout SDK has a few additional dependencies; install them with `npm`:\r\n\r\n<div class=\"HubBlock-header\">\r\n    <div class=\"HubBlock-header-title flex items-center\">\r\n        <div class=\"HubBlock-header-name\"></div>\r\n    </div><div class=\"HubBlock-header-subtitle\"></div>\r\n</div>\r\n\r\n<!--\r\ntitle: \"\"\r\nsubtitle: \"\"\r\nlineNumbers: true\r\n-->\r\n\r\n```shell\r\n# move into your theme's dir\r\ncd ~/path/to/theme/dir\r\n\r\n# install depencies\r\nnpm install --save react react-dom react-text-mask classnames accounting @babel/preset-react css-loader node-sass sass-loader style-loader @bigcommerce/checkout-sdk\r\n```\r\n\r\n### Edit `webpack.common.js`\r\n\r\nThe React app includes `.jsx` files which will not be resolved using the default webpack configuration in Cornerstone. Additionally, loaders must be registered for `.jsx` and `.scss` files.\r\n\r\nIn `webpack.common.js`, add the following objects to the `rules` arraypr:\r\n\r\n<div class=\"HubBlock-header\">\r\n    <div class=\"HubBlock-header-title flex items-center\">\r\n        <div class=\"HubBlock-header-name\"></div>\r\n    </div><div class=\"HubBlock-header-subtitle\"></div>\r\n</div>\r\n\r\n<!--\r\ntitle: \"\"\r\nsubtitle: \"\"\r\nlineNumbers: true\r\n-->\r\n\r\n```javascript\r\n{\r\n  test: /\\.jsx$/,\r\n  exclude: /node_modules/,\r\n  use: {\r\n      loader: \"babel-loader\",\r\n      options: {\r\n          presets: ['@babel/preset-react'],\r\n      },\r\n  }\r\n},\r\n{\r\n  test: /\\.scss$/,\r\n  use:  [\r\n      'style-loader',\r\n      {\r\n          loader: 'css-loader',\r\n          options: {\r\n              modules: true\r\n          }\r\n      },\r\n      'sass-loader'\r\n  ],\r\n},\r\n```\r\n\r\nNext, in `webpack.common.js`, add the following property to the `resolve` object:\r\n\r\n<div class=\"HubBlock-header\">\r\n    <div class=\"HubBlock-header-title flex items-center\">\r\n        <div class=\"HubBlock-header-name\"></div>\r\n    </div><div class=\"HubBlock-header-subtitle\"></div>\r\n</div>\r\n\r\n<!--\r\ntitle: \"\"\r\nsubtitle: \"\"\r\nlineNumbers: true\r\n-->\r\n\r\n```js\r\nextensions: ['.js', '.jsx']\r\n```\r\n\r\n### Add React Checkout Components to Theme\r\n\r\nNext, clone the `checkout-sdk-js-example` repo outside of the theme directory:\r\n\r\n<div class=\"HubBlock-header\">\r\n    <div class=\"HubBlock-header-title flex items-center\">\r\n        <div class=\"HubBlock-header-name\"></div>\r\n    </div><div class=\"HubBlock-header-subtitle\"></div>\r\n</div>\r\n\r\n<!--\r\ntitle: \"\"\r\nsubtitle: \"\"\r\nlineNumbers: true\r\n-->\r\n\r\n```shell\r\n# make sure you're in your theme's dir\r\ncd ~/path/to/theme/dir\r\n\r\n# clone the SDK example outside the theme's dir\r\ngit clone git@github.com:bigcommerce/checkout-sdk-js-example.git ../checkout-sdk-example\r\n\r\n# add directory to hold example code\r\nmkdir assets/js/checkout-app\r\n\r\n# copy example source code to directory you just created\r\ncp ../checkout-sdk-example/src/* assets/js/checkout-app/\r\n```\r\n\r\n### Import Dependencies\r\n\r\nIn `/assets/js/app.js`, add the following lines blow the existing `import` statements:\r\n\r\n<div class=\"HubBlock-header\">\r\n    <div class=\"HubBlock-header-title flex items-center\">\r\n        <div class=\"HubBlock-header-name\"></div>\r\n    </div><div class=\"HubBlock-header-subtitle\"></div>\r\n</div>\r\n\r\n<!--\r\ntitle: \"\"\r\nsubtitle: \"\"\r\nlineNumbers: true\r\n-->\r\n\r\n```js\r\nimport React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport Checkout from './checkout-app/Checkout/checkout';\r\n```\r\n\r\n### Define a Function to Initialize React\r\n\r\nIn `/assets/js/app.js`, add the following lines to the end:\r\n\r\n<div class=\"HubBlock-header\">\r\n    <div class=\"HubBlock-header-title flex items-center\">\r\n        <div class=\"HubBlock-header-name\"></div>\r\n    </div><div class=\"HubBlock-header-subtitle\"></div>\r\n</div>\r\n\r\n<!--\r\ntitle: \"\"\r\nsubtitle: \"\"\r\nlineNumbers: true\r\n-->\r\n\r\n```js\r\nwindow.initReact = function initReact() {\r\n    ReactDOM.render(\r\n        React.createElement(Checkout, null, null),\r\n        document.getElementById('checkout-app')\r\n    );\r\n};\r\n```\r\n\r\n### Customize the Checkout Template\r\n\r\nIn `/templates/pages/checkout.html`, add the following code between `{{{ footer.scripts }}}` and `{{/partial}}`:\r\n\r\n<div class=\"HubBlock-header\">\r\n    <div class=\"HubBlock-header-title flex items-center\">\r\n        <div class=\"HubBlock-header-name\"></div>\r\n    </div><div class=\"HubBlock-header-subtitle\"></div>\r\n</div>\r\n\r\n<!--\r\ntitle: \"\"\r\nsubtitle: \"\"\r\nlineNumbers: true\r\n-->\r\n\r\n```html\r\n<script src=\"{{cdn 'assets/dist/theme-bundle.main.js'}}\"></script>\r\n\r\n<script type=\"text/javascript\" defer>\r\n    // Exported in app.js\r\n    window.initReact();\r\n</script>\r\n```\r\n\r\nThen, in `/templates/pages/checkout.html`, replace:\r\n\r\n<div class=\"HubBlock-header\">\r\n    <div class=\"HubBlock-header-title flex items-center\">\r\n        <div class=\"HubBlock-header-name\"></div>\r\n    </div><div class=\"HubBlock-header-subtitle\"></div>\r\n</div>\r\n\r\n<!--\r\ntitle: \"\"\r\nsubtitle: \"\"\r\nlineNumbers: true\r\n-->\r\n\r\n```html\r\n{{ checkout.checkout_content }}\r\n```\r\n\r\nwith:\r\n\r\n<div class=\"HubBlock-header\">\r\n    <div class=\"HubBlock-header-title flex items-center\">\r\n        <div class=\"HubBlock-header-name\"></div>\r\n    </div><div class=\"HubBlock-header-subtitle\"></div>\r\n</div>\r\n\r\n<!--\r\ntitle: \"\"\r\nsubtitle: \"\"\r\nlineNumbers: true\r\n-->\r\n\r\n```\r\n<div id=\"checkout-app\"></div>\r\n```\r\n\r\n### Congratulations!\r\n\r\nYou should now be able to view your example React checkout by running the `stencil start` command in your theme directory and navigating to your storefront at http://localhost:3000/.\r\n\r\n<a id=\"implement_customization\"></a>\r\n\r\n## Additional Customizations\r\n\r\nYou can make further customizations to the checkout by modifying the React components in `/assets/js/checkout-app`.\r\n\r\n### `webpack.common.js`\r\n```js\r\nconst BundleAnalyzerPlugin = require('webpack-bundle-analyzer').BundleAnalyzerPlugin,\r\n      CleanPlugin = require('clean-webpack-plugin'),\r\n      LodashPlugin = require('lodash-webpack-plugin'),\r\n      path = require('path'),\r\n      webpack = require('webpack');\r\n\r\n// Common configuration, with extensions in webpack.dev.js and webpack.prod.js.\r\nmodule.exports = {\r\n    bail: true,\r\n    context: __dirname,\r\n    entry: {\r\n        main: './assets/js/app.js',\r\n    },\r\n    module: {\r\n        rules: [\r\n            {\r\n                test: /\\.js$/,\r\n                include: /(assets\\/js|assets\\\\js|stencil-utils)/,\r\n                use: {\r\n                    loader: 'babel-loader',\r\n                    options: {\r\n                        plugins: [\r\n                            '@babel/plugin-syntax-dynamic-import', // add support for dynamic imports (used in app.js)\r\n                            'lodash', // Tree-shake lodash\r\n                        ],\r\n                        presets: [\r\n                            ['@babel/preset-env', {\r\n                                loose: true, // Enable \"loose\" transformations for any plugins in this preset that allow them\r\n                                modules: false, // Don't transform modules; needed for tree-shaking\r\n                                useBuiltIns: 'usage', // Tree-shake babel-polyfill\r\n                                targets: '> 1%, last 2 versions, Firefox ESR',\r\n                            }],\r\n                        ],\r\n                    },\r\n                },\r\n            },\r\n            {\r\n                test: /\\.jsx$/,\r\n                exclude: /node_modules/,\r\n                use: {\r\n                    loader: \"babel-loader\",\r\n                    options: {\r\n                        presets: ['@babel/preset-react'],\r\n                    },\r\n                }\r\n              },\r\n\r\n              {\r\n                test: /\\.scss$/,\r\n                use:  [\r\n                    'style-loader',\r\n                    {\r\n                        loader: 'css-loader',\r\n                        options: {\r\n                            modules: true\r\n                        }\r\n                    },\r\n                    'sass-loader'\r\n                ],\r\n              },\r\n        ],\r\n    },\r\n    output: {\r\n        chunkFilename: 'theme-bundle.chunk.[name].js',\r\n        filename: 'theme-bundle.[name].js',\r\n        path: path.resolve(__dirname, 'assets/dist'),\r\n    },\r\n    performance: {\r\n        hints: 'warning',\r\n        maxAssetSize: 1024 * 300,\r\n        maxEntrypointSize: 1024 * 300,\r\n    },\r\n    plugins: [\r\n        new CleanPlugin(['assets/dist'], {\r\n            verbose: false,\r\n            watch: false,\r\n        }),\r\n        new LodashPlugin, // Complements babel-plugin-lodash by shrinking its cherry-picked builds further.\r\n        new webpack.ProvidePlugin({ // Provide jquery automatically without explicit import\r\n            $: 'jquery',\r\n            jQuery: 'jquery',\r\n            'window.jQuery': 'jquery',\r\n        }),\r\n        new BundleAnalyzerPlugin({\r\n            analyzerMode: 'static',\r\n            openAnalyzer: false,\r\n        }),\r\n    ],\r\n    resolve: {\r\n        alias: {\r\n            jquery: path.resolve(__dirname, 'node_modules/jquery/dist/jquery.min.js'),\r\n            jstree: path.resolve(__dirname, 'node_modules/jstree/dist/jstree.min.js'),\r\n            lazysizes: path.resolve(__dirname, 'node_modules/lazysizes/lazysizes.min.js'),\r\n            nanobar: path.resolve(__dirname, 'node_modules/nanobar/nanobar.min.js'),\r\n            'slick-carousel': path.resolve(__dirname, 'node_modules/slick-carousel/slick/slick.min.js'),\r\n            'svg-injector': path.resolve(__dirname, 'node_modules/svg-injector/dist/svg-injector.min.js'),\r\n            sweetalert2: path.resolve(__dirname, 'node_modules/sweetalert2/dist/sweetalert2.min.js'),\r\n\r\n        },\r\n        extensions: ['.js', '.jsx']\r\n    },\r\n};\r\n```\r\n\r\n### `app.js`\r\n\r\n```js\r\n__webpack_public_path__ = window.__webpack_public_path__; // eslint-disable-line\r\n\r\nimport Global from './theme/global';\r\nimport React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport Checkout from './checkout-app/Checkout/checkout';\r\n\r\nconst getAccount = () => import('./theme/account');\r\nconst getLogin = () => import('./theme/auth');\r\nconst noop = null;\r\n\r\nconst pageClasses = {\r\n    account_orderstatus: getAccount,\r\n    account_order: getAccount,\r\n    account_addressbook: getAccount,\r\n    shippingaddressform: getAccount,\r\n    account_new_return: getAccount,\r\n    'add-wishlist': () => import('./theme/wishlist'),\r\n    account_recentitems: getAccount,\r\n    account_downloaditem: getAccount,\r\n    editaccount: getAccount,\r\n    account_inbox: getAccount,\r\n    account_saved_return: getAccount,\r\n    account_returns: getAccount,\r\n    account_paymentmethods: getAccount,\r\n    account_addpaymentmethod: getAccount,\r\n    account_editpaymentmethod: getAccount,\r\n    login: getLogin,\r\n    createaccount_thanks: getLogin,\r\n    createaccount: getLogin,\r\n    getnewpassword: getLogin,\r\n    forgotpassword: getLogin,\r\n    blog: noop,\r\n    blog_post: noop,\r\n    brand: () => import('./theme/brand'),\r\n    brands: noop,\r\n    cart: () => import('./theme/cart'),\r\n    category: () => import('./theme/category'),\r\n    compare: () => import('./theme/compare'),\r\n    page_contact_form: () => import('./theme/contact-us'),\r\n    error: noop,\r\n    404: noop,\r\n    giftcertificates: () => import('./theme/gift-certificate'),\r\n    giftcertificates_balance: () => import('./theme/gift-certificate'),\r\n    giftcertificates_redeem: () => import('./theme/gift-certificate'),\r\n    default: noop,\r\n    page: noop,\r\n    product: () => import('./theme/product'),\r\n    amp_product_options: () => import('./theme/product'),\r\n    search: () => import('./theme/search'),\r\n    rss: noop,\r\n    sitemap: noop,\r\n    newsletter_subscribe: noop,\r\n    wishlist: () => import('./theme/wishlist'),\r\n    wishlists: () => import('./theme/wishlist'),\r\n};\r\n\r\nconst customClasses = {};\r\n\r\n/**\r\n * This function gets added to the global window and then called\r\n * on page load with the current template loaded and JS Context passed in\r\n * @param pageType String\r\n * @param contextJSON\r\n * @returns {*}\r\n */\r\nwindow.stencilBootstrap = function stencilBootstrap(pageType, contextJSON = null, loadGlobal = true) {\r\n    const context = JSON.parse(contextJSON || '{}');\r\n\r\n    return {\r\n        load() {\r\n            $(() => {\r\n                // Load globals\r\n                if (loadGlobal) {\r\n                    Global.load(context);\r\n                }\r\n\r\n                const importPromises = [];\r\n\r\n                // Find the appropriate page loader based on pageType\r\n                const pageClassImporter = pageClasses[pageType];\r\n                if (typeof pageClassImporter === 'function') {\r\n                    importPromises.push(pageClassImporter());\r\n                }\r\n\r\n                // See if there is a page class default for a custom template\r\n                const customTemplateImporter = customClasses[context.template];\r\n                if (typeof customTemplateImporter === 'function') {\r\n                    importPromises.push(customTemplateImporter());\r\n                }\r\n\r\n                // Wait for imports to resolve, then call load() on them\r\n                Promise.all(importPromises).then(imports => {\r\n                    imports.forEach(imported => {\r\n                        imported.default.load(context);\r\n                    });\r\n                });\r\n            });\r\n        },\r\n    };\r\n};\r\n\r\nwindow.initReact = function initReact() {\r\n    ReactDOM.render(\r\n        React.createElement(Checkout, null, null),\r\n        document.getElementById('checkout-app')\r\n    );\r\n};\r\n```\r\n\r\n### `checkout.html`\r\n```html\r\n{{#partial \"head\"}}\r\n\r\n{{{ checkout.checkout_head }}}\r\n{{{ stylesheet '/assets/css/optimized-checkout.css' }}}\r\n{{ getFontsCollection }}\r\n\r\n<script type=\"text/javascript\">\r\n    window.language = {{{langJson 'optimized_checkout'}}};\r\n</script>\r\n\r\n{{{head.scripts}}}\r\n\r\n{{/partial}}\r\n\r\n{{#partial \"page\"}}\r\n<header class=\"checkoutHeader optimizedCheckout-header\">\r\n    <div class=\"checkoutHeader-content\">\r\n        <h1 class=\"is-srOnly\">{{lang 'checkout.title'}}\r\n        <h2 class=\"checkoutHeader-heading\">\r\n            <a class=\"checkoutHeader-link\" href=\"{{urls.home}}\">\r\n                {{#if checkout.header_image}}\r\n                    <img alt=\"{{settings.store_logo.title}}\" class=\"checkoutHeader-logo\" id=\"logoImage\" src=\"{{ checkout.header_image }}\"/>\r\n                {{ else }}\r\n                    <span class=\"header-logo-text\">{{settings.store_logo.title}}</span>\r\n                {{/if}}\r\n            </a>\r\n        </h2>\r\n    </div>\r\n</header>\r\n\r\n<div id=\"checkout-app\"></div>\r\n\r\n{{{ footer.scripts }}}\r\n\r\n<script src=\"{{cdn 'assets/dist/theme-bundle.main.js'}}\"></script>\r\n\r\n<script type=\"text/javascript\" defer>\r\n    // Exported in app.js\r\n    window.initReact();\r\n</script>\r\n{{/partial}}\r\n\r\n{{> layout/empty}}\r\n```\r\n\r\n## Additional Resources\r\n\r\n* [ReactJS](https://reactjs.org/) (React)\r\n* [Tutorial: Intro to React](https://reactjs.org/tutorial/tutorial.html) (React)\r\n* [Concepts](https://webpack.js.org/concepts/) (Webpack)\r\n"}],"children":[]}}}}
